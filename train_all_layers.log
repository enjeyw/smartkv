Device: cuda
Filtering for layers: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27]
Loading data for 216 heads...
Dataset: torch.Size([58913, 216, 128])
Applying dataset balancing (oversampling positives)...
Original stats: Pos (any head)=24193, Neg=34720, Ratio=0.4107
Balanced Dataset: torch.Size([69440, 216, 128])

Training 216 binary classifiers (Hidden=256)...
Epoch 1:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 1:   0%|          | 0/8 [00:05<?, ?it/s, loss=1.1942]Epoch 1:  12%|█▎        | 1/8 [00:05<00:37,  5.35s/it, loss=1.1942]Epoch 1:  12%|█▎        | 1/8 [00:05<00:37,  5.35s/it, loss=0.5277]Epoch 1:  25%|██▌       | 2/8 [00:05<00:13,  2.29s/it, loss=0.5277]Epoch 1:  25%|██▌       | 2/8 [00:05<00:13,  2.29s/it, loss=0.4497]Epoch 1:  38%|███▊      | 3/8 [00:05<00:06,  1.31s/it, loss=0.4497]Epoch 1:  38%|███▊      | 3/8 [00:05<00:06,  1.31s/it, loss=0.4476]Epoch 1:  50%|█████     | 4/8 [00:05<00:03,  1.17it/s, loss=0.4476]Epoch 1:  50%|█████     | 4/8 [00:06<00:03,  1.17it/s, loss=0.4527]Epoch 1:  62%|██████▎   | 5/8 [00:06<00:02,  1.49it/s, loss=0.4527]Epoch 1:  62%|██████▎   | 5/8 [00:06<00:02,  1.49it/s, loss=0.4300]Epoch 1:  75%|███████▌  | 6/8 [00:06<00:00,  2.03it/s, loss=0.4300]Epoch 1:  75%|███████▌  | 6/8 [00:06<00:00,  2.03it/s, loss=0.4143]Epoch 1:  88%|████████▊ | 7/8 [00:06<00:00,  2.62it/s, loss=0.4143]Epoch 1:  88%|████████▊ | 7/8 [00:06<00:00,  2.62it/s, loss=0.3900]Epoch 1: 100%|██████████| 8/8 [00:06<00:00,  1.19it/s, loss=0.3900]
Epoch 1 | Train Loss: 0.5383 | Val Loss: 0.3819
Epoch 2:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 2:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.3721]Epoch 2:  12%|█▎        | 1/8 [00:02<00:16,  2.31s/it, loss=0.3721]Epoch 2:  12%|█▎        | 1/8 [00:02<00:16,  2.31s/it, loss=0.3487]Epoch 2:  25%|██▌       | 2/8 [00:02<00:07,  1.32s/it, loss=0.3487]Epoch 2:  25%|██▌       | 2/8 [00:03<00:07,  1.32s/it, loss=0.3441]Epoch 2:  38%|███▊      | 3/8 [00:03<00:03,  1.27it/s, loss=0.3441]Epoch 2:  38%|███▊      | 3/8 [00:03<00:03,  1.27it/s, loss=0.3289]Epoch 2:  50%|█████     | 4/8 [00:03<00:02,  1.87it/s, loss=0.3289]Epoch 2:  50%|█████     | 4/8 [00:03<00:02,  1.87it/s, loss=0.3293]Epoch 2:  62%|██████▎   | 5/8 [00:03<00:01,  1.99it/s, loss=0.3293]Epoch 2:  62%|██████▎   | 5/8 [00:03<00:01,  1.99it/s, loss=0.3210]Epoch 2:  75%|███████▌  | 6/8 [00:03<00:00,  2.29it/s, loss=0.3210]Epoch 2:  75%|███████▌  | 6/8 [00:04<00:00,  2.29it/s, loss=0.3094]Epoch 2:  88%|████████▊ | 7/8 [00:04<00:00,  2.91it/s, loss=0.3094]Epoch 2:  88%|████████▊ | 7/8 [00:04<00:00,  2.91it/s, loss=0.3081]Epoch 2: 100%|██████████| 8/8 [00:04<00:00,  1.81it/s, loss=0.3081]
Epoch 2 | Train Loss: 0.3327 | Val Loss: 0.3030
Epoch 3:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 3:   0%|          | 0/8 [00:01<?, ?it/s, loss=0.2906]Epoch 3:  12%|█▎        | 1/8 [00:01<00:13,  2.00s/it, loss=0.2906]Epoch 3:  12%|█▎        | 1/8 [00:02<00:13,  2.00s/it, loss=0.2934]Epoch 3:  25%|██▌       | 2/8 [00:02<00:07,  1.32s/it, loss=0.2934]Epoch 3:  25%|██▌       | 2/8 [00:02<00:07,  1.32s/it, loss=0.2815]Epoch 3:  38%|███▊      | 3/8 [00:02<00:03,  1.27it/s, loss=0.2815]Epoch 3:  38%|███▊      | 3/8 [00:03<00:03,  1.27it/s, loss=0.2826]Epoch 3:  50%|█████     | 4/8 [00:03<00:02,  1.87it/s, loss=0.2826]Epoch 3:  50%|█████     | 4/8 [00:03<00:02,  1.87it/s, loss=0.2742]Epoch 3:  62%|██████▎   | 5/8 [00:03<00:01,  2.49it/s, loss=0.2742]Epoch 3:  62%|██████▎   | 5/8 [00:03<00:01,  2.49it/s, loss=0.2671]Epoch 3:  75%|███████▌  | 6/8 [00:03<00:00,  2.16it/s, loss=0.2671]Epoch 3:  75%|███████▌  | 6/8 [00:04<00:00,  2.16it/s, loss=0.2667]Epoch 3:  88%|████████▊ | 7/8 [00:04<00:00,  2.77it/s, loss=0.2667]Epoch 3:  88%|████████▊ | 7/8 [00:04<00:00,  2.77it/s, loss=0.2640]Epoch 3: 100%|██████████| 8/8 [00:04<00:00,  1.85it/s, loss=0.2640]
Epoch 3 | Train Loss: 0.2775 | Val Loss: 0.2659
Epoch 4:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 4:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.2672]Epoch 4:  12%|█▎        | 1/8 [00:02<00:14,  2.01s/it, loss=0.2672]Epoch 4:  12%|█▎        | 1/8 [00:02<00:14,  2.01s/it, loss=0.2602]Epoch 4:  25%|██▌       | 2/8 [00:02<00:08,  1.41s/it, loss=0.2602]Epoch 4:  25%|██▌       | 2/8 [00:03<00:08,  1.41s/it, loss=0.2518]Epoch 4:  38%|███▊      | 3/8 [00:03<00:04,  1.20it/s, loss=0.2518]Epoch 4:  38%|███▊      | 3/8 [00:03<00:04,  1.20it/s, loss=0.2522]Epoch 4:  50%|█████     | 4/8 [00:03<00:02,  1.77it/s, loss=0.2522]Epoch 4:  50%|█████     | 4/8 [00:03<00:02,  1.77it/s, loss=0.2461]Epoch 4:  62%|██████▎   | 5/8 [00:03<00:01,  1.96it/s, loss=0.2461]Epoch 4:  62%|██████▎   | 5/8 [00:04<00:01,  1.96it/s, loss=0.2463]Epoch 4:  75%|███████▌  | 6/8 [00:04<00:00,  2.27it/s, loss=0.2463]Epoch 4:  75%|███████▌  | 6/8 [00:04<00:00,  2.27it/s, loss=0.2425]Epoch 4:  88%|████████▊ | 7/8 [00:04<00:00,  2.89it/s, loss=0.2425]Epoch 4:  88%|████████▊ | 7/8 [00:04<00:00,  2.89it/s, loss=0.2342]Epoch 4: 100%|██████████| 8/8 [00:04<00:00,  1.82it/s, loss=0.2342]
Epoch 4 | Train Loss: 0.2501 | Val Loss: 0.2440
Epoch 5:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 5:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.2427]Epoch 5:  12%|█▎        | 1/8 [00:02<00:18,  2.66s/it, loss=0.2427]Epoch 5:  12%|█▎        | 1/8 [00:02<00:18,  2.66s/it, loss=0.2373]Epoch 5:  25%|██▌       | 2/8 [00:02<00:07,  1.18s/it, loss=0.2373]Epoch 5:  25%|██▌       | 2/8 [00:02<00:07,  1.18s/it, loss=0.2373]Epoch 5:  38%|███▊      | 3/8 [00:02<00:03,  1.39it/s, loss=0.2373]Epoch 5:  38%|███▊      | 3/8 [00:03<00:03,  1.39it/s, loss=0.2345]Epoch 5:  50%|█████     | 4/8 [00:03<00:01,  2.02it/s, loss=0.2345]Epoch 5:  50%|█████     | 4/8 [00:03<00:01,  2.02it/s, loss=0.2290]Epoch 5:  62%|██████▎   | 5/8 [00:03<00:01,  2.20it/s, loss=0.2290]Epoch 5:  62%|██████▎   | 5/8 [00:03<00:01,  2.20it/s, loss=0.2304]Epoch 5:  75%|███████▌  | 6/8 [00:03<00:00,  2.41it/s, loss=0.2304]Epoch 5:  75%|███████▌  | 6/8 [00:04<00:00,  2.41it/s, loss=0.2327]Epoch 5:  88%|████████▊ | 7/8 [00:04<00:00,  2.59it/s, loss=0.2327]Epoch 5:  88%|████████▊ | 7/8 [00:04<00:00,  2.59it/s, loss=0.2290]Epoch 5: 100%|██████████| 8/8 [00:04<00:00,  1.79it/s, loss=0.2290]
Epoch 5 | Train Loss: 0.2341 | Val Loss: 0.2338
Epoch 6:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 6:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.2241]Epoch 6:  12%|█▎        | 1/8 [00:02<00:17,  2.54s/it, loss=0.2241]Epoch 6:  12%|█▎        | 1/8 [00:02<00:17,  2.54s/it, loss=0.2247]Epoch 6:  25%|██▌       | 2/8 [00:02<00:06,  1.14s/it, loss=0.2247]Epoch 6:  25%|██▌       | 2/8 [00:02<00:06,  1.14s/it, loss=0.2248]Epoch 6:  38%|███▊      | 3/8 [00:02<00:03,  1.46it/s, loss=0.2248]Epoch 6:  38%|███▊      | 3/8 [00:02<00:03,  1.46it/s, loss=0.2254]Epoch 6:  50%|█████     | 4/8 [00:02<00:01,  2.11it/s, loss=0.2254]Epoch 6:  50%|█████     | 4/8 [00:03<00:01,  2.11it/s, loss=0.2259]Epoch 6:  62%|██████▎   | 5/8 [00:03<00:01,  1.90it/s, loss=0.2259]Epoch 6:  62%|██████▎   | 5/8 [00:03<00:01,  1.90it/s, loss=0.2262]Epoch 6:  75%|███████▌  | 6/8 [00:03<00:00,  2.50it/s, loss=0.2262]Epoch 6:  75%|███████▌  | 6/8 [00:03<00:00,  2.50it/s, loss=0.2240]Epoch 6:  88%|████████▊ | 7/8 [00:03<00:00,  3.14it/s, loss=0.2240]Epoch 6:  88%|████████▊ | 7/8 [00:04<00:00,  3.14it/s, loss=0.2222]Epoch 6: 100%|██████████| 8/8 [00:04<00:00,  1.90it/s, loss=0.2222]
Epoch 6 | Train Loss: 0.2246 | Val Loss: 0.2268
Epoch 7:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 7:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.2217]Epoch 7:  12%|█▎        | 1/8 [00:02<00:20,  2.94s/it, loss=0.2217]Epoch 7:  12%|█▎        | 1/8 [00:03<00:20,  2.94s/it, loss=0.2199]Epoch 7:  25%|██▌       | 2/8 [00:03<00:07,  1.30s/it, loss=0.2199]Epoch 7:  25%|██▌       | 2/8 [00:03<00:07,  1.30s/it, loss=0.2197]Epoch 7:  38%|███▊      | 3/8 [00:03<00:03,  1.29it/s, loss=0.2197]Epoch 7:  38%|███▊      | 3/8 [00:03<00:03,  1.29it/s, loss=0.2159]Epoch 7:  50%|█████     | 4/8 [00:03<00:02,  1.89it/s, loss=0.2159]Epoch 7:  50%|█████     | 4/8 [00:04<00:02,  1.89it/s, loss=0.2176]Epoch 7:  62%|██████▎   | 5/8 [00:04<00:01,  1.76it/s, loss=0.2176]Epoch 7:  62%|██████▎   | 5/8 [00:04<00:01,  1.76it/s, loss=0.2164]Epoch 7:  75%|███████▌  | 6/8 [00:04<00:00,  2.35it/s, loss=0.2164]Epoch 7:  75%|███████▌  | 6/8 [00:04<00:00,  2.35it/s, loss=0.2156]Epoch 7:  88%|████████▊ | 7/8 [00:04<00:00,  2.98it/s, loss=0.2156]Epoch 7:  88%|████████▊ | 7/8 [00:04<00:00,  2.98it/s, loss=0.2166]Epoch 7: 100%|██████████| 8/8 [00:04<00:00,  1.73it/s, loss=0.2166]
Epoch 7 | Train Loss: 0.2179 | Val Loss: 0.2215
Epoch 8:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 8:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.2114]Epoch 8:  12%|█▎        | 1/8 [00:02<00:15,  2.28s/it, loss=0.2114]Epoch 8:  12%|█▎        | 1/8 [00:02<00:15,  2.28s/it, loss=0.2134]Epoch 8:  25%|██▌       | 2/8 [00:02<00:07,  1.32s/it, loss=0.2134]Epoch 8:  25%|██▌       | 2/8 [00:03<00:07,  1.32s/it, loss=0.2121]Epoch 8:  38%|███▊      | 3/8 [00:03<00:03,  1.27it/s, loss=0.2121]Epoch 8:  38%|███▊      | 3/8 [00:03<00:03,  1.27it/s, loss=0.2127]Epoch 8:  50%|█████     | 4/8 [00:03<00:02,  1.87it/s, loss=0.2127]Epoch 8:  50%|█████     | 4/8 [00:03<00:02,  1.87it/s, loss=0.2127]Epoch 8:  62%|██████▎   | 5/8 [00:03<00:01,  2.36it/s, loss=0.2127]Epoch 8:  62%|██████▎   | 5/8 [00:04<00:01,  2.36it/s, loss=0.2142]Epoch 8:  75%|███████▌  | 6/8 [00:04<00:00,  2.03it/s, loss=0.2142]Epoch 8:  75%|███████▌  | 6/8 [00:04<00:00,  2.03it/s, loss=0.2098]Epoch 8:  88%|████████▊ | 7/8 [00:04<00:00,  2.62it/s, loss=0.2098]Epoch 8:  88%|████████▊ | 7/8 [00:04<00:00,  2.62it/s, loss=0.2151]Epoch 8: 100%|██████████| 8/8 [00:04<00:00,  1.78it/s, loss=0.2151]
Epoch 8 | Train Loss: 0.2127 | Val Loss: 0.2175
Epoch 9:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 9:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.2090]Epoch 9:  12%|█▎        | 1/8 [00:02<00:19,  2.73s/it, loss=0.2090]Epoch 9:  12%|█▎        | 1/8 [00:03<00:19,  2.73s/it, loss=0.2093]Epoch 9:  25%|██▌       | 2/8 [00:03<00:07,  1.31s/it, loss=0.2093]Epoch 9:  25%|██▌       | 2/8 [00:03<00:07,  1.31s/it, loss=0.2102]Epoch 9:  38%|███▊      | 3/8 [00:03<00:03,  1.28it/s, loss=0.2102]Epoch 9:  38%|███▊      | 3/8 [00:03<00:03,  1.28it/s, loss=0.2063]Epoch 9:  50%|█████     | 4/8 [00:03<00:02,  1.88it/s, loss=0.2063]Epoch 9:  50%|█████     | 4/8 [00:03<00:02,  1.88it/s, loss=0.2093]Epoch 9:  62%|██████▎   | 5/8 [00:03<00:01,  2.40it/s, loss=0.2093]Epoch 9:  62%|██████▎   | 5/8 [00:04<00:01,  2.40it/s, loss=0.2058]Epoch 9:  75%|███████▌  | 6/8 [00:04<00:00,  2.08it/s, loss=0.2058]Epoch 9:  75%|███████▌  | 6/8 [00:04<00:00,  2.08it/s, loss=0.2073]Epoch 9:  88%|████████▊ | 7/8 [00:04<00:00,  2.68it/s, loss=0.2073]Epoch 9:  88%|████████▊ | 7/8 [00:04<00:00,  2.68it/s, loss=0.2042]Epoch 9: 100%|██████████| 8/8 [00:04<00:00,  1.73it/s, loss=0.2042]
Epoch 9 | Train Loss: 0.2077 | Val Loss: 0.2139
Epoch 10:   0%|          | 0/8 [00:00<?, ?it/s]Epoch 10:   0%|          | 0/8 [00:02<?, ?it/s, loss=0.2063]Epoch 10:  12%|█▎        | 1/8 [00:02<00:20,  2.95s/it, loss=0.2063]Epoch 10:  12%|█▎        | 1/8 [00:03<00:20,  2.95s/it, loss=0.2057]Epoch 10:  25%|██▌       | 2/8 [00:03<00:07,  1.30s/it, loss=0.2057]Epoch 10:  25%|██▌       | 2/8 [00:03<00:07,  1.30s/it, loss=0.2047]Epoch 10:  38%|███▊      | 3/8 [00:03<00:03,  1.29it/s, loss=0.2047]Epoch 10:  38%|███▊      | 3/8 [00:03<00:03,  1.29it/s, loss=0.2015]Epoch 10:  50%|█████     | 4/8 [00:03<00:02,  1.89it/s, loss=0.2015]Epoch 10:  50%|█████     | 4/8 [00:03<00:02,  1.89it/s, loss=0.2025]Epoch 10:  62%|██████▎   | 5/8 [00:03<00:01,  2.11it/s, loss=0.2025]Epoch 10:  62%|██████▎   | 5/8 [00:04<00:01,  2.11it/s, loss=0.2042]Epoch 10:  75%|███████▌  | 6/8 [00:04<00:00,  2.48it/s, loss=0.2042]Epoch 10:  75%|███████▌  | 6/8 [00:04<00:00,  2.48it/s, loss=0.2008]Epoch 10:  88%|████████▊ | 7/8 [00:04<00:00,  3.12it/s, loss=0.2008]Epoch 10:  88%|████████▊ | 7/8 [00:04<00:00,  3.12it/s, loss=0.2014]Epoch 10: 100%|██████████| 8/8 [00:04<00:00,  1.80it/s, loss=0.2014]
Epoch 10 | Train Loss: 0.2034 | Val Loss: 0.2107
Saving models to models/gates_binary_256_v3...
